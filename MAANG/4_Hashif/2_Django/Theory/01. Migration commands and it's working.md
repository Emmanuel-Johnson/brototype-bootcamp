# Migration Commands & How They Work in Django

## 1. What is it?
In Django, migrations are how changes to your models (like adding a field, removing one, renaming a model, etc.) get translated into actual database schema changes.

They’re Django’s way of keeping your Python models and your database tables in sync — without you having to manually write SQL.

## 2. Why it matters?
- Automates schema changes.
- Keeps DB consistent with models.
- Enables version control of DB structure.
- You change Python, Django handles SQL.

## 3. Migration Commands (Core Set)

### 🛠️ `python manage.py makemigrations`
**Purpose:** Generates migration files based on the changes in your models.

Django scans all apps, detects changes, and creates a new migration file in `app/migrations/`.

```bash
python manage.py makemigrations
```
**Example Output:**
```
Migrations for 'products':
    products/migrations/0002_auto_add_price_field.py
```

### 🔁 `python manage.py migrate`
**Purpose:** Applies the migrations to your actual database (creates/updates tables, etc.).

```bash
python manage.py migrate
```
Reads migration files and runs the necessary SQL commands under the hood.

### 🔍 `python manage.py showmigrations`
**Purpose:** Lists all migration files, and shows whether each one has been applied ✅ or not ❌

```bash
python manage.py showmigrations
```

### 🧼 `python manage.py sqlmigrate <app_name> <migration_number>`
**Purpose:** Shows the raw SQL that will run for a specific migration.

```bash
python manage.py sqlmigrate accounts 0001
```
Useful to preview what Django is about to do before hitting the DB.

### 🧽 `python manage.py flush`
**Purpose:** Deletes all data from the database and resets sequences, but keeps the schema.

```bash
python manage.py flush
```
Useful during dev/testing — **WARNING:** It wipes data 🔥

### 🧹 `python manage.py migrate --fake <app_name> <migration_number>`
**Purpose:** Marks the migration as applied without actually running it.

Used in tricky cases like manual DB changes or resolving broken migrations.

### ⏪ Rollback: Undoing Migrations
**Purpose:** Revert your database schema to a previous state.

```bash
python manage.py migrate <app_name> <previous_migration_number>
```
This command rolls back migrations for the specified app to the given migration. For example, to undo the last migration:

```bash
python manage.py migrate products 0001
```
**Note:** Rolling back can result in data loss if fields/tables are removed.

## 4. Behind the Scenes
- Migration files live inside `your_app/migrations/`
- They’re Python scripts with Migration classes — Django reads and runs them.
- Django keeps track of applied migrations in a special table called `django_migrations`.

## 🧠 Interview Explanation

In Django, migrations are used to propagate changes made to models into the database schema. The command `makemigrations` generates migration files based on model changes, while `migrate` applies those changes to the database. Django also provides commands like `showmigrations` to list migration status and `sqlmigrate` to preview the underlying SQL. Migration files act as version-controlled Python scripts that track schema evolution, and Django stores the state of applied migrations in the `django_migrations` table. This system ensures a smooth, database-safe way to handle schema updates during development and deployment.